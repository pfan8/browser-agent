%%{init: {'theme': 'base', 'themeVariables': { 'primaryColor': '#4f46e5', 'primaryTextColor': '#fff', 'primaryBorderColor': '#4338ca', 'lineColor': '#6366f1', 'secondaryColor': '#f0abfc', 'tertiaryColor': '#c4b5fd'}}}%%
flowchart TD
    subgraph AgentLoop["üîÑ Planner + CodeAct Loop"]
        START([‚ñ∂ START])
        planner["üß† PLANNER<br/><small>High-level task planning (LLM decides next step)</small>"]
        codeact["‚ö° CODEACT<br/><small>Code generation & execution (Playwright)</small>"]
    end

    START --> planner
    codeact --> planner
    planner -->|"codeact"| codeact
    planner -->|"end"| END1
    END1([üèÅ END])

    subgraph Conditions["üìã Termination Conditions"]
        direction LR
        C1["isComplete = true"]
        C2["status = 'error'"]
        C3["maxIterations reached"]
    end

    style START fill:#6366f1,stroke:#4f46e5,color:#fff
    style planner fill:#a855f7,stroke:#9333ea,color:#fff
    style codeact fill:#22c55e,stroke:#16a34a,color:#fff
    style END1 fill:#ef4444,stroke:#dc2626,color:#fff
    style AgentLoop fill:#f8fafc,stroke:#e2e8f0
    style Conditions fill:#fef3c7,stroke:#fcd34d